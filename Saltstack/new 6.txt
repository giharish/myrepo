On the master install package for minion
salt <minion name> pkg.install python-inotify

On the Salt minion, add the following configuration to /etc/salt/minion.d/beacons.conf
#Beacon Config
beacons:
  inotify:
    - files:
        /etc/testfile:
          mask:
            - modify
    - disable_during_state_run: True
	
beacons:
  service:
  - services:
	  SNMP-Service:
	    onchangeonly: True
	
To view the events on the master
salt-run state.event pretty=true

On salt master configure reactor
mkdir -p /srv/reactor

Create the file reactor.sls
revert-file:
  local.state.apply:
    - tgt: {{ data['data']['id'] }}
    - arg:
      - maintain_test_file
	  
On the master create a state file to maintain the file in /srv/salt/maintain_test_file.sls
important_file:
  file.managed:
    - name: /etc/testfile
    - contents: |
        important_config: True

On the master configure the reactor to reack to events (/etc/salt/master.d/reactor.conf)		
reactor:
  - salt/beacon/*/inotify//etc/testfile:
    - /srv/reactor/revert.sls
	
Salt in debug mode start

service salt-master stop
salt-master -l debug


sysctl parameters
kernel.msgmax   8192
kernel.msgmnb   16384
kernel.msgmni	32000
kernel.shmmax   18446744073692774399
kernel.shmmni	4096
net.ipv4.ip_forward = 0
net.ipv4.conf.all.send_redirects	0 
net.ipv4.conf.default.send_redirects	0
net.ipv4.route.flush	1
net.ipv4.conf.all.accept_source_route	0
net.ipv4.icmp_echo_ignore_broadcasts	1
net.ipv4.icmp_ignore_bogus_error_responses	1
net.ipv4.tcp_syncookies	1

net.ipv6.conf.all.disable_ipv6 = 1
net.ipv6.conf.all.forwarding = 0
net.ipv6.conf.all.accept_ra = 0
net.ipv6.conf.all.accept_source_route = 0
net.ipv6.conf.default.accept_source_route = 0
net.ipv6.conf.all.accept_redirects = 0
net.ipv6.conf.default.accept_redirects = 0
net.ipv6.conf.default.accept_ra = 0

fs.protected_hardlinks = 1
fs.protected_symlinks = 1
fs.suid_dumpable = 0

kernel.kptr_restrict = 1
kernel.yama.ptrace_scope = 1
kernel.dmesg_restrict = 1

/etc/security/limits.conf, /etc/security/limits.d/
*     hard   core    0



Disable DCCP
Disable SCTP
Disable the xserver_object_manager SELinux Boolean
Disable Automounter
Disable Modprobe Loading of USB Storage Driver
 Disable rexec Service
 Disable rlogin Service 
Uninstall telnet-server Package
Disable xinetd Service
Remove NIS Client

Uninstall rsh-server Package

sed -i.bak 's/^\(dev.raid.speed_limit_max\)/#\1/g' sysctl-minion1.conf

awk '{if($0 ~ /^dev.raid.speed_limit_max/){print "#"$0}else{print $0}}' sysctl-minion1.conf

perl -i -pe 's/-/ $&/' /tmp/list

awk '{if($0 ~ /-/){print " "$0}else{print $0}}' /tmp/list

/etc/ssh/sshd_config 
	Protocol 2
	LogLevel INFO
	PermitRootLogin no
	PermitEmptyPasswords no
systemctl restart sshd

/etc/pam.d -- 644 permissions

authconfig --passalgo=sha512 --update ----> SHA512 Algorithm for Password

/etc/security/limits.conf
	* hard core 0
	* soft core 0
	
/etc/sysctl.d/9999-disable-core-dump.conf
	fs.suid_dumpable=0
	kernel.core_pattern=|/bin/false

sysctl -p /etc/sysctl.d/9999-disable-core-dump.conf